- title "#{@user.name}'s Anime Library"

.large-12.columns.watchlist-option-bar
  .large-2.columns
    %p.option-title Anime Library
  .large-9.columns.options
    %ul.status-tabs.inline-list
      %li.active#tab-all= link_to "All", "#all", onclick: "showRelevantSections('all')"
      - Watchlist.valid_statuses.each do |status|
        %li{:id => "tab-" + status.parameterize}= link_to status, "##{status.parameterize}", onclick: "showRelevantSections(#{status.parameterize.inspect})"

- Watchlist.valid_statuses.each do |status|
  .watchlist-row{:id => "table-" + status.parameterize}
    .large-12.columns.library-status-header
      %h5.status= status
    .row
      .large-12.columns.library-table
        .loading.center{:style => "background-color: #fff; padding: 16px; border-bottom: 1px solid #f1f1f1"}
          %i.icon.icon-spin.icon-spinner.icon-2x

.large-12.columns.library-status-header
  %h5.status Currently Watching
.row
  .large-12.columns.library-table
    %table.large-12.columns.fake-table-row
      %thead
        %tr
          %th{:width => "505"}= link_to "Title", "#", :class => "active"
          %th{:width => "95"}= link_to "Progress", "#"
          %th{:width => "68"}= link_to "Rating", "#"
          %th{:width => "65"}= link_to "Type", "#"

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Attack on Titan", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Devil Survivor 2 The Animation", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Fullmetal Alchemist: Brotherhood", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Kore wa Zombie Desu ka?", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    // The class .private makes the private indicator appear
    %table.large-12.columns.fake-table-row.library-item.private
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Boku No Pico", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    #divToShow.large-12.columns.library-dropdown{:style => "display:block;"}
      .large-8.columns.meta-content
        .large-12.columns.last-update
          %p Last Library Update: 04-03-13
        .large-2.columns.thumbnail
          = image_tag "http://hummingbird.ly/system/2fc4434fe83de4b00ac707d201b741f44474f385_thumb.jpg?1361874445"
        
        // Left side of dropdown with thumbnail and description
        .large-10.columns.library-item-info
          = link_to "Boku no Pico", "#", :class => "title"
          .rating
            <i class="icon-star"></i>
            <i class="icon-star-empty"></i>
            <i class="icon-star-empty"></i>
            <i class="icon-star-empty"></i>
            <i class="icon-star-empty"></i>
          %span.description
            #{truncate("During summer vacation, Tamotsu is on break from work happens to visit a particular café. It is at this café that Tamotsu meets Pico, who works there for his grandfather. Tamotsu instantly falls for Pico, believing that Pico is a girl because of his feminine appearance. However, to his disbelief, Pico claims he actually is a guy. Undeterred, Tamotsu pursues a sexual relationship with Pico, to an extent where he even persuades Pico into wearing girl clothes. When Pico asks what is he to Tamotsu, he finds himself unable to answer...", :length => 280, :separator => ' ')}
          %span.description-link= link_to "[Read More]", "#"

      // Right side of dropdown with update content
      .large-4.columns.action-area
        .large-12.columns.library-status
          .large-3.columns.option-label
            %span Status:
          .large-9.columns.status-dropdown
            %form.custom
              %select.medium
                %option Currently Watching
                %option Want to Watch
                %option Completed
                %option Dropped

        .large-12.columns.privacy-setting
          .large-3.columns.option-label
            %span Privacy:
          .large-9.columns.privacy-dropdown
            %form.custom
              %select.medium
                %option Public
                %option Private

        .large-12.columns.remove-from-library.text-center
          %span 
            %i.icon-remove
            = link_to "Remove From Library", "#"

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Natsume Yuujinchou Shi", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Natsume’s Book of Friends Three", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Spice and Wolf", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Children Who Chase Lost Voices", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Magi: The Labyrinth of Magic", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV



.large-12.columns.library-status-header
  %h5.status Want to Watch
.row
  .large-12.columns.library-table
    %table.large-12.columns.fake-table-row
      %thead
        %tr
          %th{:width => "505"}= link_to "Title", "#", :class => "active"
          %th{:width => "95"}= link_to "Progress", "#"
          %th{:width => "68"}= link_to "Rating", "#"
          %th{:width => "65"}= link_to "Type", "#"

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Colorful", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Monster", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Paprika", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Shigofumi", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

    %table.large-12.columns.fake-table-row.library-item
      %tr
        %td.library-item-title{:width => "505"}
          = link_to "Magi: The Labyrinth of Magic", "#"
          %span.private-indicator [PRIVATE]
          %i.icon-reorder
        %td.episode-count{:width => "95"} 
          <a href="#" class="click-add"><i class="icon-caret-up"></i></a>
          <a href="#" class="click-remove"><i class="icon-caret-down"></i></a>
          <span class="edit">03</span> <strong>/ 25</strong>
        %td{:width => "68"} <span class="select"><i class="icon-star"></i> 5</span>
        %td{:width => "65"} TV

:coffee
  setActiveTab = (section) ->
    $(".watchlist-option-bar .options li").removeClass "active"
    $(".watchlist-option-bar .options #tab-" + section).addClass "active"
    
  @showRelevantSections = (x...) ->
    section = if x[0] then x[0] else window.location.hash.substring(1)
    valids = #{Watchlist.valid_statuses.map {|x| x.parameterize }.inspect}
    if _.contains valids, section
      setActiveTab section
      $(".watchlist-row").hide()
      $("#table-" + section).show()
    else
      setActiveTab "all"
      $(".watchlist-row").show()
      
  showRelevantSections()
  
    
:javascript
  $(function() {
    $("table").click(function(event) {
      var control = $('#divToShow').toggle();                  
    });
  });
  $(document).ready(function() {
    $('.edit').editable('http://www.example.com/save.php', {
        indicator : 'Saving...',
        tooltip   : 'Click to edit...'
    });
  });
  $('.select').editable('http://www.example.com/save.php', { 
    data   : " {'1':'1 Star','2':'2 Stars','3':'3 Stars', '4':'4 Stars', '5':'5 Stars'}",
    type   : 'select'
  });
  
/       %ul.inline-list.view
/         %li.active
/           %a{:href => "#"} <i class="icon-list"></i>
/         %li
/           %a{:href => "#"} <i class="icon-th"></i>

/       %h3= @sub_tab.titleize
/       %table.tableSorter.large-12.columns.responsive
/         %tr.table-head
/           %th Anime Title
/           %th Score
/           /%th Type
/           %th Progress
/           %th Review
/           - if user_signed_in? and @user == current_user
/             %th Update
/         - @watchlist.each do |w|
/           %tr
/             %td= link_to w.anime.canonical_title(current_user), w.anime
/             %td
/               - if w.rating
/                 - if @user.star_rating?
/                   %i.icon-star
/                   = w.rating + 3
/                 - else
/                   - if w.positive?
/                     \:)
/                   - elsif w.meh?
/                     \:|
/                   - elsif w.negative?
/                     \:(
/               - else
/                 \-
/             %td
/               - if w.anime.episode_count and w.anime.episode_count > 0
/                 #{((w.episodes_watched.to_f * 100) / w.anime.episode_count).round}%
/                 (
/                 = w.episodes_watched
/                 \/
/                 = w.anime.episode_count
/                 )
/             %td
/               - if review = @user.reviews.where(anime_id: w.anime).first
/                 = link_to "Read Review", anime_review_path(w.anime, review)
/               - elsif user_signed_in? and @user == current_user
/                 = link_to "Write One!", new_anime_review_path(w.anime)
/               - else
/                 \-
/             %td
/               - if user_signed_in? and @user == current_user
/                 %a{"data-reveal-id" => "watchlist_#{w.anime.slug}", :href => "#"} Update

/ - if user_signed_in? and @user == current_user
/   = render partial: "watchlists/form_modal", collection: @watchlist, as: :watchlist

/ :javascript
/   $(function() {
/     $('table.tableSorter').tableSort();
/   });

