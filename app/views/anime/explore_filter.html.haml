- title "Explore Anime"

.anime-discover.anime-explore
  .row
    .large-3.columns
      = form_tag("/anime", method: :get) do
        = hidden_field_tag "filter", true
        .panel.rounded-panel
          .large-12.columns
            %h4.top-title.pull-left Popular
            = submit_tag "Apply", class: "pull-right button submit-button"
            %hr.title-divider

            .large-12.columns
              .row.filter-section
                %label.checkbox
                  = radio_button_tag :s, "all", @sort == "all"
                  All Time
                %label.checkbox
                  = radio_button_tag :s, "year", @sort == "year", disabled: true
                  This Year
                %label.checkbox
                  = radio_button_tag :s, "month", @sort == "month", disabled: true
                  This Month
                %label.checkbox
                  = radio_button_tag :s, "week", @sort == "week", disabled: true
                  This Week

        .panel.rounded-panel
          .large-12.columns
            %h4.top-title.pull-left Airing Date
            = submit_tag "Apply", class: "pull-right button submit-button"
            %hr.title-divider
            .large-12.columns
              .row.filter-section
                %label.checkbox
                  = radio_button_tag :s, "newest", @sort == "newest"
                  Newest First
                %label.checkbox
                  = radio_button_tag :s, "oldest", @sort == "oldest"
                  Oldest First
     
        .panel.rounded-panel
          .large-12.columns
            %h4.top-title.pull-left Year
            = submit_tag "Apply", class: "pull-right button submit-button"
            %hr.title-divider

            .large-12.columns
              .row.filter-section
                %label.checkbox
                  %input.select-all(type="checkbox"){:checked => @filter_years.all? {|y| @years.include? y }}
                  All
                - @filter_years.each do |year|
                  %label.checkbox
                    = check_box_tag "y[]", year, @years.include?(year)
                    = year

        .panel.rounded-panel
          .large-12.columns
            %h4.top-title.pull-left Genres
            = submit_tag "Apply", class: "pull-right button submit-button"
            %hr.title-divider

            .large-12.columns.filter-section
              .row
                .large-12.columns
                  %label.checkbox
                    %input.select-all(type="checkbox"){:checked => Genre.default_filterable(current_user).all? {|g| @genres.include? g }}
                    All
                - Genre.default_filterable(current_user).each do |genre|
                  .large-6.columns
                    %label.checkbox
                      = check_box_tag "g[]", genre.slug, @genres.include?(genre)
                      = genre.name
                      
                      
    :coffee
      $("input.select-all").change ->
        if $(this).prop "checked"
          $(this).closest(".filter-section").find("input").prop "checked", true
        else
          $(this).closest(".filter-section").find("input").prop "checked", false

      $("input").change ->
        if $(this).closest(".rounded-panel").find(".submit-button").is(":hidden")
          $(".rounded-panel .submit-button").fadeOut()
          $(this).closest(".rounded-panel").find(".submit-button").fadeIn()


    / Anime Listing.
    .large-9.columns.no-padding
      .large-12.columns
        %h4.top-title Anime
        %hr.title-divider
        .large-12.columns.no-padding.trending-panel
          %ul
            - @anime.each do |anime|
              %li.large-2.columns.single-wrapper
                = link_to anime do
                  .popular-card.tip-top(data-tooltip){"title" => anime.canonical_title(current_user)}
                    %p.wanna-watch
                    = image_tag anime.cover_image.url(:thumb), alt: anime.canonical_title
                    %p.title= anime.canonical_title(current_user)
                
          = paginate @anime

