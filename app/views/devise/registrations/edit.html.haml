- @active_tab = :account_settings
= render "users/dash"

.dashboard
  .row.content-body
    .twelve.columns
      .account-settings
        %h3= title "Edit Account Settings"

        = form_for(resource, as: resource_name, url: registration_path(resource_name), :html => { :method => :put, :multipart => true }) do |f|
          = devise_error_messages!

          .nine.columns.push-three
            %p 
              = f.label :name
              = f.text_field :name
            %p
              = f.label :email
              = f.email_field :email

              - if devise_mapping.confirmable? and resource.pending_reconfirmation?
                %p Currently waiting confirmation for: #{resource.unconfirmed_email}
            %p
              = f.label :bio
              = f.text_field :bio
            %p 
              = f.label :password, "New Password"
              %i (leave blank if you don't want to change it)
              = f.password_field :password, :autocomplete => "off"

            %p.password-confirmation-box
              = f.label :password_confirmation
              = f.password_field :password_confirmation
            
            %p
              = f.label :sfw_filter
              = f.check_box :sfw_filter

            %p
              = f.label :star_rating
              = f.check_box :star_rating
              
            %p
              = f.submit "Update"

          / Sidebar
          .three.columns.pull-nine
            %ul.side-nav
              %li
                = f.label :avatar
                %span.user-avatar= image_tag current_user.avatar_url
                = f.file_field :avatar
              %li

  .row.content-body
    .twelve.columns
      %h3 Import
      %form
        %fieldset
          %legend Import from MyAnimeList
          .row
            .five.columns
              .six.columns
                %label.right MyAnimeList Username:
              .six.columns
                %input
          .row
            %input(type="submit" class="small button" value="Import")

:javascript
  $(".password-confirmation-box").slideUp();
  $("div.dashboard input#user_password").focus(function() {
    $(".password-confirmation-box").slideDown();
  });
  $("div.dashboard input#user_password").blur(function() {
    if ($("div.dashboard input#user_password").val().length > 0) {
      $(".password-confirmation-box").slideUp();
    }
  });
